---
import type { Comment } from "@/types/bakend-types";
import PersonIcon from "@/assets/person.svg";
import StarGroup from "./StarGroup.astro";
import Like from "@/assets/like.svg";

const comment = Astro.props.data as Comment;
if (!comment) return;
---

<div class="bg-lightSalmon max-w-96 m-3 p-2 rounded-md scroll-fade-in min-w-80">
  <div class="p-5">
    <div class="flex items-center space-x-3 mb-2">
      {
        comment.url_img ? (
          <img src={comment.url_img} alt="User Icon" class="w-7 h-7 rounded-full" />
        ) : (
          <PersonIcon class="w-7 h-7" />
        )
      }
      <div>
        <p class="text-xs">@{comment.name}</p>
        <StarGroup star={comment.stars} size={"16px"} />
      </div>
    </div>
    <p class="text-xs">{comment.timestamp}</p>
  </div>
  <p class="pl-5">
    {comment.content}
  </p>
  <div class="flex justify-end space-x-2">
    <div
      class={`flex justify-end space-x-1 cursor-pointer like-icon`}
      data-id={comment.author_uid}
      data-users-liked={JSON.stringify(comment.users_liked ?? [])}
    >
      <Like class={`like-svg`} />
      <span class="min-w-5 text-center">{(comment.like ?? 0) ? comment.like : 0}</span>
    </div>
  </div>
</div>
<style>
  .like-svg {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    color: #6b7280;
    fill: #cbcbcb;
  }

  .like-icon.liked .like-svg,
  .like-svg.liked {
    color: var(--color-red);
    fill: var(--color-light-red);
    animation: likeAnimation 0.6s ease-in-out;
  }

  .like-svg:hover {
    color: var(--color-red);
    transform: scale(1.1);
  }

  .like-svg.pulse {
    animation: pulseEffect 0.3s ease-out;
  }

  @keyframes likeAnimation {
    0% {
      transform: scale(1);
    }
    15% {
      transform: scale(1.2);
    }
    30% {
      transform: scale(0.95);
    }
    45% {
      transform: scale(1.1);
    }
    60% {
      transform: scale(0.98);
    }
    100% {
      transform: scale(1);
    }
  }
  @keyframes pulseEffect {
    0% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.3);
    }
    100% {
      transform: scale(1);
    }
  }
</style>
